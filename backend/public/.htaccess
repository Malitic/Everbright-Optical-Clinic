RewriteEngine On

# Handle CORS preflight requests
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

# Route API requests to appropriate PHP files
RewriteCond %{REQUEST_URI} ^/api/branches$
RewriteRule ^api/branches$ api/branches.php [L]

RewriteCond %{REQUEST_URI} ^/api/analytics/realtime$
RewriteRule ^api/analytics/realtime$ api/router.php [L]

RewriteCond %{REQUEST_URI} ^/api/analytics/trends
RewriteRule ^api/analytics/trends.*$ api/router.php [L]

RewriteCond %{REQUEST_URI} ^/api/admin/analytics
RewriteRule ^api/admin/analytics.*$ api/router.php [L]

RewriteCond %{REQUEST_URI} ^/api/admin/feedback/analytics
RewriteRule ^api/admin/feedback/analytics.*$ api/router.php [L]

RewriteCond %{REQUEST_URI} ^/api/admin/users
RewriteRule ^api/admin/users.*$ api/router.php [L]

RewriteCond %{REQUEST_URI} ^/api/notifications
RewriteRule ^api/notifications.*$ api/notifications.php [L]

RewriteCond %{REQUEST_URI} ^/api/login$
RewriteRule ^api/login$ api/login-real.php [L]

# Fallback for any other API routes
RewriteCond %{REQUEST_URI} ^/api/
RewriteRule ^api/(.*)$ api/router.php [L]